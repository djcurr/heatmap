<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Heat Map</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  </head>
  <body>
    <script>
      const req = new XMLHttpRequest();
      req.open(
        'GET',
        'https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/global-temperature.json',
        true
      );
      req.send();
      req.onload = () => {
        let data = JSON.parse(req.responseText);
        console.log(data.monthlyVariance);
        var margin = { top: 20, right: 10, bottom: 40, left: 70 };
        const w = 1000;
        const h = 400;
        const svg = d3.select('body').append('svg').attr('viewBox', [0, 0, w, h]);

        var years = [];
        for (var i = 1753; i <= 2014; i++) {
          years.push(i);
        }
        var months = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];

        var x = d3
          .scaleBand()
          .range([0, w])
          .domain([...years]);

        svg
          .append('g')
          .attr('transform', 'translate(0,' + h + ')')
          .call(d3.axisBottom(x));

        var y = d3
          .scaleBand()
          .range([h, 0])
          .domain([...months]);

        svg.append('g').call(d3.axisLeft(y));

        var myColor = d3
          .scaleQuantize()
          .domain([-7, 6])
          .range([
            '#5E4FA2',
            '#3288BD',
            '#66C2A5',
            '#ABDDA4',
            '#E6F598',
            '#FFFFBF',
            '#FEE08B',
            '#FDAE61',
            '#F46D43',
            '#D53E4F',
            '#9E0142',
            '#e64c00',
          ]);
        svg
          .selectAll()
          .data(data.monthlyVariance)
          .enter()
          .append('rect')
          .attr('x', (d) => x(d.year))
          .attr('y', (d) => h - y(d.month))
          .attr('width', x.bandwidth())
          .attr('height', y.bandwidth())
          .style('fill', (d) => myColor(d.variance));

        svg
          .append('text')
          .attr('x', w / 2)
          .attr('y', 20)
          .attr('text-anchor', 'middle')
          .style('font-size', '20px')
          .text('Heat Map');
      };
    </script>
  </body>
</html>
